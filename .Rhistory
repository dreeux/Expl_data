library(data.table)
library(zoo)
library(forecast)
library(ggplot2)
library(dplyr)

test <- fread("C:/Users/amulya/Documents/Kaggle/forecast/test.csv")

train <- fread("C:/Users/amulya/Documents/Kaggle/forecast/train.csv")

store <- fread("C:/Users/amulya/Documents/Kaggle/forecast/store.csv")

str(train)

str(test)

str(store)

train[, Date := as.Date(Date)]

test[, Date := as.Date(Date)]

train <- train[order(Date)]

test <- test[order(Date)]

#combine data

train <- data.frame(train) ; test <- data.frame(test)

train <- left_join(train, store, by = "Store")

train <- filter(train, Open == 1) 

ggplot(train, aes( x = Customers, y =Sales)) + geom_point() + labs(title = "Customers and Sales")

names(train)

per_customer <- train[ Sales != 0, mean(Sales / Customers), by = "Store"]

quantile(per_customer$V1)

ggplot(per_customer, aes( y = V1 , x = Store )) + geom_line()

ggplot(per_customer, aes( y = (V1) , x = Store )) + geom_jitter(alpha = 0.2) + 
geom_boxplot(colour = "Blue", outlier.colour = "black", fill = NA) + labs( y = "Revenue per User")

per_customer[V1 < 4 | V1 > 15]

Outliers <- train[Store %in% c(158, 353, 455, 612, 769, 842)]

ggplot(train[Store %in% c(158, 353, 455, 612, 769, 842)], aes( x = Customers, y = Sales)) + geom_point()

